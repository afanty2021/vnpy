[æ ¹ç›®å½•](../../../CLAUDE.md) > [vnpy](../../) > **chart**

# Chart - å›¾è¡¨ç»„ä»¶

> æ›´æ–°æ—¶é—´ï¼š2025-12-09 11:33:34

## æ¨¡å—èŒè´£

Chartæ¨¡å—æä¾›äº†åŸºäºPyQtGraphçš„é«˜æ€§èƒ½å›¾è¡¨ç»„ä»¶ï¼Œä¸“é—¨ä¸ºé‡åŒ–äº¤æ˜“åœºæ™¯ä¼˜åŒ–ã€‚æ”¯æŒKçº¿å›¾ã€æˆäº¤é‡å›¾ã€æŠ€æœ¯æŒ‡æ ‡å›¾ç­‰å¤šç§å›¾è¡¨ç±»å‹ï¼Œå¯ä¸äº¤æ˜“æ•°æ®æ— ç¼é›†æˆã€‚

## å…¥å£ä¸å¯åŠ¨

### ä¸»è¦å…¥å£
- `ChartWidget` - ä¸»å›¾è¡¨æ§ä»¶
- `CandleItem` - Kçº¿å›¾é¡¹
- `VolumeItem` - æˆäº¤é‡å›¾é¡¹

### åŸºæœ¬ä½¿ç”¨
```python
from vnpy.chart import ChartWidget, CandleItem, VolumeItem

# åˆ›å»ºå›¾è¡¨æ§ä»¶
chart_widget = ChartWidget()
chart_widget.setWindowTitle("å“ç§ Kçº¿å›¾")

# æ·»åŠ Kçº¿å›¾
candle_item = CandleItem()
chart_widget.add_item(candle_item)

# æ·»åŠ æˆäº¤é‡å›¾
volume_item = VolumeItem()
chart_widget.add_item(volume_item, y_axis=1)

# æ›´æ–°æ•°æ®
chart_widget.update_bar(bar_data)
```

## å¯¹å¤–æ¥å£

### ChartWidgetæ¥å£
- `add_item()` - æ·»åŠ å›¾è¡¨é¡¹
- `remove_item()` - ç§»é™¤å›¾è¡¨é¡¹
- `clear_all()` - æ¸…ç©ºæ‰€æœ‰æ•°æ®
- `update_bar()` - æ›´æ–°Kçº¿æ•°æ®
- `update_history()` - æ›´æ–°å†å²æ•°æ®
- `add_plot()` - æ·»åŠ æ–°çš„ç»˜å›¾åŒºåŸŸ
- `add_cursor()` - æ·»åŠ åå­—çº¿

### åŸºç¡€å›¾è¡¨é¡¹
- `ChartItem` - æ‰€æœ‰å›¾è¡¨é¡¹çš„åŸºç±»
- `CandleItem` - Kçº¿å›¾
- `VolumeItem` - æˆäº¤é‡æŸ±çŠ¶å›¾
- `LineItem` - çº¿å›¾
- `ScatterItem` - æ•£ç‚¹å›¾
- `HistogramItem` - ç›´æ–¹å›¾

## å…³é”®ä¾èµ–ä¸é…ç½®

### æ ¸å¿ƒä¾èµ–
- `pyqtgraph` - é«˜æ€§èƒ½ç§‘å­¦ç»˜å›¾åº“
- `PySide6` - GUIæ¡†æ¶
- `numpy` - æ•°å€¼è®¡ç®—
- `pandas` - æ•°æ®å¤„ç†

### æ•°æ®è¦æ±‚
- BarDataå¯¹è±¡ï¼ˆæ¥è‡ªtraderæ¨¡å—ï¼‰
- æ—¶é—´åºåˆ—æ•°æ®éœ€æŒ‰æ—¶é—´æ’åº

## æ•°æ®æ¨¡å‹

### å›¾è¡¨æ•°æ®ç»“æ„
- åŸºäºPyQtGraphçš„PlotDataItem
- æ”¯æŒåŠ¨æ€æ›´æ–°å’Œæ»šåŠ¨æ˜¾ç¤º
- è‡ªåŠ¨å¤„ç†åæ ‡è½´å’Œç½‘æ ¼

### æ”¯æŒçš„å›¾è¡¨ç±»å‹
1. **Kçº¿å›¾**ï¼šå¼€é«˜ä½æ”¶ä»·æ ¼
2. **æˆäº¤é‡å›¾**ï¼šäº¤æ˜“é‡æŸ±çŠ¶å›¾
3. **æŠ€æœ¯æŒ‡æ ‡å›¾**ï¼šMAã€MACDã€RSIç­‰
4. **æ•£ç‚¹å›¾**ï¼šç‚¹ä½æ ‡è®°
5. **çº¿å›¾**ï¼šä»·æ ¼åºåˆ—æˆ–æŒ‡æ ‡

## é«˜çº§åŠŸèƒ½

### å¤šåæ ‡è½´
- ä¸»åæ ‡è½´ï¼šä»·æ ¼
- å‰¯åæ ‡è½´ï¼šæˆäº¤é‡ã€æŒ‡æ ‡å€¼
- æ”¯æŒåŠ¨æ€æ·»åŠ æ–°çš„åæ ‡è½´

### äº¤äº’åŠŸèƒ½
- åå­—çº¿è·Ÿè¸ª
- ç¼©æ”¾å’Œå¹³ç§»
- æ•°æ®æç¤ºï¼ˆTooltipï¼‰
- å›¾ä¾‹æ˜¾ç¤º

### æ€§èƒ½ä¼˜åŒ–
- æ•°æ®é‡‡æ ·å‡å°‘æ¸²æŸ“è´Ÿæ‹…
- å¢é‡æ›´æ–°é¿å…é‡ç»˜
- è§†å£è£å‰ªåªç»˜åˆ¶å¯è§éƒ¨åˆ†

## æ‰©å±•å¼€å‘

### è‡ªå®šä¹‰å›¾è¡¨é¡¹
ç»§æ‰¿`ChartItem`åŸºç±»ï¼š
```python
class CustomItem(ChartItem):
    def __init__(self):
        super().__init__()

    def update_history(self, history_data: list[BarData]):
        # å®ç°å†å²æ•°æ®å¤„ç†
        pass

    def update_bar(self, bar: BarData):
        # å®ç°å®æ—¶æ•°æ®å¤„ç†
        pass

    def paint(self, painter, option, widget):
        # å®ç°ç»˜å›¾é€»è¾‘
        pass
```

### æ·»åŠ æŠ€æœ¯æŒ‡æ ‡
```python
# è®¡ç®—æŒ‡æ ‡å€¼
ma_values = calculate_moving_average(bars, period=20)

# æ·»åŠ åˆ°å›¾è¡¨
ma_item = LineItem("MA20")
chart_widget.add_item(ma_item)
```

## å¸¸è§é—®é¢˜ (FAQ)

### Q: å¦‚ä½•å¤„ç†å¤§é‡å†å²æ•°æ®ï¼Ÿ
A: ä½¿ç”¨æ•°æ®é‡‡æ ·ï¼Œæ¯”å¦‚1åˆ†é’Ÿçº¿æ˜¾ç¤ºæ—¶é‡‡æ ·5åˆ†é’Ÿæˆ–15åˆ†é’Ÿçº¿ã€‚

### Q: å¦‚ä½•å®ç°å¤šå“ç§å åŠ ï¼Ÿ
A: åˆ›å»ºå¤šä¸ªChartWidgetï¼Œæˆ–è®¡ç®—ä»·æ ¼æ¯”ç‡åå åŠ ã€‚

### Q: å¦‚ä½•å¯¼å‡ºå›¾è¡¨ï¼Ÿ
A: ä½¿ç”¨PyQtGraphçš„å¯¼å‡ºåŠŸèƒ½ï¼Œæˆ–æˆªå›¾ä¿å­˜ã€‚

## ç›¸å…³æ–‡ä»¶æ¸…å•

- `__init__.py` - æ¨¡å—å¯¼å‡º
- `widget.py` - ChartWidgetä¸»æ§ä»¶
- `item.py` - å„ç§å›¾è¡¨é¡¹å®ç°
- `manager.py` - å›¾è¡¨ç®¡ç†å™¨
- `base.py` - ChartItemåŸºç±»
- `axis.py` - åæ ‡è½´æ‰©å±•

## å˜æ›´è®°å½• (Changelog)

### 2025-12-09 11:33:34
- âœ¨ åˆ›å»ºchartæ¨¡å—æ–‡æ¡£
- ğŸ“Š æ•´ç†å›¾è¡¨ç»„ä»¶æ¶æ„
- ğŸ”§ è¯´æ˜æ ¸å¿ƒæ¥å£å’Œæ‰©å±•æ–¹æ³•
- ğŸ“ æä¾›æ€§èƒ½ä¼˜åŒ–å»ºè®®

---

*æç¤ºï¼šè¯¥æ¨¡å—ä¸“æ³¨äºå®æ—¶å›¾è¡¨æ˜¾ç¤ºï¼Œé€‚åˆé«˜é¢‘æ›´æ–°åœºæ™¯ã€‚å¯¹äºå¤æ‚çš„å›¾è¡¨åˆ†æï¼Œå»ºè®®ç»“åˆå…¶ä»–ä¸“ä¸šå›¾è¡¨åº“ã€‚*